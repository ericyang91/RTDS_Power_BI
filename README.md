# Road to Data Science: Power BI
## Data Preparation

**To make Excel or CSV data Power BI compatible, your goal is to structure it in a clean, tabular, and relational-friendly format that Power BI can easily interpret and transform into visuals.**

---

**1. Structure your data in a tabular format**
- Each sheet (in Excel) or file (CSV) should resemble a table in a database.
- Each row should represent a single record or transaction.
- Each column should represent one variable or attribute.
- Power BI will easily recognize the "Good" table. It will struggle to understand the "Bad" one ‚Äî especially if headers are spread across multiple rows/columns.

| Good Format               | Bad Format                      |
| ------------------------ | ------------------------------ |
| Column headers in row 1   | Column headers in row 3         |
| No merged cells           | Merged cells across months      |
| Each row = 1 data entry   | Headers split across rows/cols  |

---

‚úÖ Example (Good Format)

| Date       | Product | Quantity | Price |
|------------|---------|----------|-------|
| 2025-06-01 | Apples  | 10       | 0.50  |

---

‚ùå Example (Bad Format ‚Äì Merged header or missing labels)

|          | Apples | Oranges |
|----------|--------|---------|
| Quantity | 10     | 12      |
| Price    | 0.50   | 0.80    |

---

**2. Use proper headers**
- Headers = Column names, and they must:
  - Be in row 1 (no intro rows like ‚ÄúSales Report Q2‚Äù above it).
  - Have no duplicates.
  - Use simple, descriptive names like ProductName, not Column1.
  - Power BI reads the first row as headers. If the first row contains actual data, you‚Äôll have to fix it manually during import (Power Query ‚Üí ‚ÄúUse First Row as Headers‚Äù).

---

**3. Avoid pivoted/crosstab layouts**
- Power BI prefers long format, not wide format.
- Why?
  - Visuals like bar charts and filters work better with vertical data.
  - You can use ```UNPIVOT``` in Power Query if needed.

---

‚ùå Pivoted Format (Not Ideal for Power BI)

| Region | Jan | Feb | Mar |
|--------|-----|-----|-----|
| West   | 100 | 200 | 150 |

---

‚úÖ Unpivoted Format (Tidy / Power BI Friendly)

| Region | Month | Sales |
|--------|--------|-------|
| West   | Jan    | 100   |
| West   | Feb    | 200   |
| West   | Mar    | 150   |

- Power BI can now group by Region, filter by Month, and aggregate Sales.

---

**4. Use separate tables for each entity**
- Example setup for a sales dashboard:
  - ```Sales:``` Transactional table
  - ```Customers:``` Info on customers
  - ```Products:``` Product info (name, category, etc.)
  - ```Calendar:``` All dates
 - Each table should have:
  - A **primary key** (like ProductID).
  - Clean, distinct columns (no overlapping names unless it‚Äôs a key for a relationship).
  - Use **Model View in Power BI** to connect them (one-to-many relationships).

---

**5. Ensure clean data**
- Why this matters: Power BI auto-detects data types. Mixed types can break visuals or calculations.
- Watch out for:
  - Columns with numbers and text (12, 15, --N/A--).
  - Dates in wrong format (e.g., text "01/2024" instead of date 2024-01-01).
  - Totals/subtotals (these should be calculated in Power BI, not stored).

---

**6. Avoid extra rows/columns**
- Many Excel sheets start with title rows like:
  
TD SALES REPORT - Q2
 
Generated by: Eric

Date | Product | Qty | Price

  - ‚ùå Problem: Power BI may read these as data.
  - ‚úÖ Solution: Remove these extra rows, or place clean tables on a separate sheet just for import.

---

**7. Save in Compatible Formats**
- Best practice:
  - Excel: .xlsx or .xls (keep sheets tidy)
  - CSV: UTF-8 encoding, comma-separated (no semicolons or tabs unless needed)
    - Why CSVs are nice:
      - Lightweight and load fast
      - Easy to version-control (e.g., Git)
      - Compatible across platforms
     
---

**8. Use a calendar table**

### üìÖ Calendar Table Example

- Time intelligence (e.g., YTD, MOM, YOY) requires a full calendar ‚Äî not just the dates in your data.
- A calendar table should include columns like:

| Date       | Year | Month | Quarter | Week | DayName |
|------------|------|--------|---------|------|---------|
| 2025-01-01 | 2025 | Jan    | Q1      | 1    | Wed     |
| 2025-01-02 | 2025 | Jan    | Q1      | 1    | Thu     |
| 2025-01-03 | 2025 | Jan    | Q1      | 1    | Fri     |
| 2025-01-04 | 2025 | Jan    | Q1      | 1    | Sat     |
| 2025-01-05 | 2025 | Jan    | Q1      | 1    | Sun     |
| 2025-01-06 | 2025 | Jan    | Q1      | 2    | Mon     |

- You can:
  - Generate it in Excel
  - Use Power BI DAX:
    - ```Calendar = CALENDAR(DATE(2020,1,1), DATE(2030,12,31))```
    - Then relate ```Sales[Date]``` ‚Üí ```Calendar[Date]```.
   
---



**9. Avoid Formulas in Excel**

- Avoid using formulas like `=SUM(...)`, `=VLOOKUP(...)`, or `=IF(...)` in Excel ‚Äî they can be fragile or lost when importing.
- Power BI uses its own formula language called **DAX**, which is more robust and scalable.
- Example (DAX):
```DAX
TotalSales = SUM(Sales[Quantity] * Sales[Price])
```
- Best practice: Export raw data only from Excel or CSV, and do your calculations inside Power BI using DAX.

---

**10. Name Your Excel Tables (Optional but Useful)**

- In Excel:
  - Select your data ‚Üí press Ctrl + T
  - Check "My table has headers"
  - Go to the Table Design tab ‚Üí Rename it (e.g., SalesTable)
- Why this helps:
  - Power BI will recognize and list tables by name instead of "Sheet1".
  - Makes your queries more readable and manageable.
  - Easier refresh when the source file updates.
